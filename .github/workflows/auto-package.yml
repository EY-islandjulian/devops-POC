name: Auto Package

on:
  push:
    branches:
      - devops-POC  # Trigger the action on push to the 'devops-POC' branch
  workflow_dispatch:  # You can manually trigger this workflow as well

jobs:
  zip:
    runs-on: ubuntu-latest  # Use the latest Ubuntu runner

    steps:
      - name: Checkout code
        uses: actions/checkout@v3  # Check out the repository's code

      - name: Install zip (if necessary)
        run: sudo apt-get install -y zip  # Install zip command if not available

      - name: Zip contents of a folder
        run: |
          folder_name="H2OA_CM065.001"  # Specify the folder to zip
          zip -r "H2OA_CM065.001.zip" "$folder_name"  # Zip the folder

      - name: Set up Git
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"

      - name: Commit and push the zip file to the branch
        run: |
          git add H2OA_CM065.001.zip  # Add the zip file to staging
          git commit -m "Add zip file H2OA_CM065.001.zip"  # Commit the zip file
          git push origin devops-POC  # Push the commit to the devops-POC branch
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}  # Use the GitHub token for authentication
