05UTF-801522CM-MigrationDataImport00049https://10.1.9.133:6501/ouaf/usermap?language=ENG2025-10-10-14.26.43010022214F1_IWS_SVC_ANN027001411IN_SVC_NAME05N0025406ANN_CD01N0001007VERSION11N05Y07SEQ_NUM11N03Y12F1_IWS_SVC_L0310901611IN_SVC_NAME05N0025411LANGUAGE_CD01N0000305DESCR05N0006009DESCRLONG05Y0400009OWNER_FLG04N407VERSION11N05Y09CI_SCR_DA0312501706SCR_CD01N0001207DA_NAME05N0003011DA_TYPE_FLG04N411SCHEMA_NAME01N0003015SCHEMA_TYPE_FLG04N407VERSION11N05Y09OWNER_FLG04N412CI_SCR_PRMPT0313601806SCR_CD01N0001212STEP_SEQ_NUM11N05N07SEQ_NUM11N03Y08SORT_SEQ11N02Y13NEXT_SORT_SEQ11N05Y10DEFAULT_SW02N07VERSION11N05Y09OWNER_FLG04N420F1_IWS_SVC_OPER_PARM0314901711IN_SVC_NAME05N0025414OPERATION_NAME05N0025412PARM_EXT_REF05N0003007VERSION11N05Y09OWNER_FLG04N418OPER_PARM_TYPE_FLG04N415OPER_PARM_XPATH01N0025419F1_IWS_SVC_OPER_OPT0313901711IN_SVC_NAME05N0025414OPERATION_NAME05N0025415IWS_OPR_OPT_FLG04N407SEQ_NUM11N03Y15IWS_OPR_OPT_VAL05N3200009OWNER_FLG04N407VERSION11N05Y10F1_IWS_SVC03310021611IN_SVC_NAME05N0025414DFLT_OPER_NAME05N0025408TRACE_SW02N08DEBUG_SW02N09ACTIVE_SW02N13POST_ERROR_SW02N09OWNER_FLG04N416SERVICE_REVISION11N05N07VERSION11N05Y10BUS_OBJ_CD01N0003012BO_DATA_AREA06Y17WEB_SVC_CLASS_FLG04N417RESOURCE_CAT_XFLG05N0003013URI_COMPONENT01Y0006016IWS_REST_VER_FLG04Y411PUBLISH_FLG04N417F1_IWS_SVC_SCHEMA0312401611IN_SVC_NAME05N0025415IWS_SCHEMA_NAME05N0025419IWS_SCHEMA_TYPE_FLG04N409OWNER_FLG04N415IWS_SCHEMA_DEFN06Y07VERSION11N05Y08CI_SCR_L0310701606SCR_CD01N0001211LANGUAGE_CD01N0000307VERSION11N05Y08DESCR25405N0025409OWNER_FLG04N409DESCR400005Y0400011CI_SCR_STEP03751023711BUTTON_NAME05N0005014CRT_A_FLD_NAME05N0010018CRT_A_FLD_TYPE_FLG04N414CRT_B_FLD_NAME05N0010018CRT_B_FLD_TYPE_FLG04N413CRT_B_FLD_VAL05N0010013DEST_FLD_NAME05N0010017DEST_FLD_TYPE_FLG04N410DISPLAY_SW02N12DISP_ICON_CD01N0001214FALSE_SORT_SEQ11N05N07FUNC_CD01N0001211IF_TYPE_FLG04N412MATH_OPR_FLG04N410NAV_OPT_CD01N0003213NEXT_SORT_SEQ11N05Y15PROMPT_TYPE_FLG04N406SCR_CD01N0001209SORT_SEQ511N05Y12SRC_FLD_NAME05N0010016SRC_FLD_TYPE_FLG04N411SRC_FLD_VAL05N0010013STEP_TYPE_FLG04N410SUB_SCR_CD01N0001206HEIGHT05N0000513TRUE_SORT_SEQ11N05N15HEIGHT_TYPE_FLG04N407VERSION11N05Y11SCHEMA_NAME01N0003015SCHEMA_TYPE_FLG04N413TERMINATE_FLG04N413BO_ACTION_FLG04N414EDIT_DATA_AREA06N15TARGET_AREA_FLG04N409OWNER_FLG04N412STEP_SEQ_NUM11N05N17SCR_STEP_WARN_FLG04N409F1_SCHEMA029101511SCHEMA_NAME01N0003015SCHEMA_TYPE_FLG04N407VERSION11N05Y11SCHEMA_DEFN06N09OWNER_FLG04N416CI_SCR_CRT_GRP_L0312601706SCR_CD01N0001215SCR_CRT_GRP_NBR11N03N11LANGUAGE_CD01N0000307VERSION11N05Y05DESCR05N0006008DESCR25405N0025409OWNER_FLG04N417F1_IWS_SVC_OPER_L0313301711IN_SVC_NAME05N0025414OPERATION_NAME05N0025411LANGUAGE_CD01N0000307VERSION11N05Y09OWNER_FLG04N405DESCR05N0006009DESCRLONG05Y0400014CI_SCR_PRMPT_L0312501712STEP_SEQ_NUM11N05N06SCR_CD01N0001207SEQ_NUM11N03Y11LANGUAGE_CD01N0000307VERSION11N05Y10LABEL_LONG05N0006009OWNER_FLG04N413CI_SCR_STEP_L0312401712STEP_SEQ_NUM11N05N06SCR_CD01N0001211LANGUAGE_CD01N0000307VERSION11N05Y11TEXT_VAR_SW02N08SCR_TEXT05N0200009OWNER_FLG04N406CI_SCR03197021006SCR_CD01N0001216SCR_ELIG_OPT_FLG04N407VERSION11N05Y17SCR_INVOC_OPT_FLG04N412SCR_TYPE_FLG04N414ALG_ENTITY_FLG04N410APP_SVC_ID01N0002009OWNER_FLG04N410BUS_OBJ_CD01N0003018SCR_ENGINE_VER_FLG04N418F1_IWS_SVC_FLDTEXT0313601711IN_SVC_NAME05N0025409TEXT_NAME01N0003013IWS_HELP_TEXT05N0400012EXAMPLE_TEXT05Y0400008FLD_NAME01N0003009OWNER_FLG04N407VERSION11N05Y15F1_IWS_SVC_CHAR03252021211IN_SVC_NAME05N0025412CHAR_TYPE_CD01N0000807SEQ_NUM11N03Y08CHAR_VAL01N0001614ADHOC_CHAR_VAL05N0025412CHAR_VAL_FK105N0005012CHAR_VAL_FK205N0005012CHAR_VAL_FK305N0005012CHAR_VAL_FK405N0005012CHAR_VAL_FK505N0005013SRCH_CHAR_VAL05N0005007VERSION11N05Y10CI_SCR_CRT03335021606SCR_CD01N0001215SCR_CRT_GRP_NBR11N03N07SEQ_NUM11N03Y07VERSION11N05Y09SORT_SEQ511N05Y18SCCRT_FLD_TYPE_FLG04N418SCCRT_CHAR_ENT_FLG04N412CHAR_TYPE_CD01N0000815CRT_COMP_ALG_CD01N0001214CRT_FLD_ALG_CD01N0001211CRT_OPR_FLG04N418CRT_TRUE_INSTR_FLG04N418CRT_FALS_INSTR_FLG04N418CRT_INSF_INSTR_FLG04N412CRT_COMP_VAL05N0025409OWNER_FLG04N415F1_IWS_SVC_OPER03339021611IN_SVC_NAME05N0025414OPERATION_NAME05N0025414REQUEST_SCHEMA05N0010015RESPONSE_SCHEMA05N0010011REQUEST_XSL05N0010012RESPONSE_XSL05N0010011SCHEMA_NAME01N0003015SCHEMA_TYPE_FLG04N414TRANS_TYPE_FLG04N415SEARCH_TYPE_FLG04N412MAINT_OBJ_CD01Y0001207SEQ_NUM11N03Y20REST_HTTP_METHOD_FLG04N412RESOURCE_URI01N0010009OWNER_FLG04N407VERSION11N05Y14CI_SCR_FLD_MAP03198021006SCR_CD01N0001212STEP_SEQ_NUM11N05N07FUNC_CD01N0001213FUNC_FLD_NAME01N0002007VERSION11N05Y17DEST_FLD_TYPE_FLG04N416SRC_FLD_TYPE_FLG04N411MAP_FLD_VAL05N0010012MAP_FLD_NAME05N0010009OWNER_FLG04N414CI_SCR_CRT_GRP0313701706SCR_CD01N0001215SCR_CRT_GRP_NBR11N03N07VERSION11N05Y09SORT_SEQ511N05Y18GRP_TRUE_INSTR_FLG04N418GRP_FALS_INSTR_FLG04N409OWNER_FLG04N401320F1-InboundWebService09F1-IWSSVC01018CM-MigrationImport01109F1-IWSSVC01018CM-MigrationImport30F1-InboundWebServicePhysicalBO010039171010F1_IWS_SVC01100018CM-MigrationImport00000NNYNCM  0150170024F1-InboundRESTWebService010F1RT00008F1-ADMIN0016/migrationImportF120    14F1_IWS_SVC_ANN01015F1_IWS_SVC_CHAR01018F1_IWS_SVC_FLDTEXT01012F1_IWS_SVC_L01100018CM-MigrationImport0003ENG00016Migration Import00000CM  01115F1_IWS_SVC_OPER01200018CM-MigrationImport00022addMigrationDataImport000000000000000000000011CM_AddMgrDtF1SC        0000010POST0001/CM  01500018CM-MigrationImport00022getMigrationDataImport000000000000000000000012CM_GetMgObErF1SC        00000210GET 0008/{mdsId}CM  01417F1_IWS_SVC_OPER_L01200018CM-MigrationImport00022addMigrationDataImport0003ENG011CM  00025Add Migration Data Import0000000018CM-MigrationImport00022getMigrationDataImport0003ENG011CM  00025Get Migration Data Import0000019F1_IWS_SVC_OPER_OPT01020F1_IWS_SVC_OPER_PARM01100018CM-MigrationImport00022getMigrationDataImport00005mdsId011CM  PATH0005mdsId17F1_IWS_SVC_SCHEMA01013F1-ScriptOnly06SCRIPT01012CM_GetMgObEr01106SCRIPT01012CM_GetMgObEr19F1-ScriptPhysicalBO0100453001206CI_SCR0110012CM_GetMgObErSENE0261    SVSC    0008F1-DFLTSCM  0000F13014CI_SCR_CRT_GRP01010CI_SCR_CRT01016CI_SCR_CRT_GRP_L01009CI_SCR_DA0130012CM_GetMgObEr00030F1-RetrieveBoStatusDescriptionSCHM0030F1-RetrieveBoStatusDescriptionF1BS011CM  0012CM_GetMgObEr00008F1MDSUPOSCHM0008F1MDSUPOF1BS011CM  0012CM_GetMgObEr00004parmSCSM0012CM_GetMgObErF1SC011CM  08CI_SCR_L0110012CM_GetMgObEr0003ENG01100031Retrieve Migration Object ErrorCM  0000011CI_SCR_STEP0160000000000    00000    0000000000    N00000100000        0000010    0012CM_GetMgObEr021000000    00000LABL000000000010    0120000            010    CM  011    0000000000    00000    0000000000    N00000100000        0000010    0012CM_GetMgObEr023000000    00000EDDT000000000010    0150000            0220invokeGroovy 'main';    CM  012    0000000000    00000    0000000000    N00000100000        0000010    0012CM_GetMgObEr025000000    00000GVYM000000000010    02350000            041023void main(){
  	
  	mdsId = evalString("parm/mdsId");
  
    move mdsId, "F1MDSUPO/mdsId";
    invokeBS 'F1MDSUPO', "F1MDSUPO";
  
  	status = evalString("F1MDSUPO/Results/status");
  	hasErrorObjs = evalString("F1MDSUPO/Results/hasErrorObjs");
  	hasErrorTrans = evalString("F1MDSUPO/Results/hasErrorTrans");
  	move status, "parm/status";
  	
  	//Retrieve Business Object Status Description
  	move "F1-MigrDataSetImport", "F1-RetrieveBoStatusDescription/bo";
  	move status, "F1-RetrieveBoStatusDescription/boStatus";
    invokeBS 'F1-RetrieveBoStatusDescription', "F1-RetrieveBoStatusDescription";
    move evalString("F1-RetrieveBoStatusDescription/description"), "parm/statusDescription";
  	
  	if(hasErrorObjs.equals('Y') || hasErrorTrans.equals('Y')){
      
      	move true, "parm/hasError";
      
        //Retrieve Error Message
      	List<String> messages = getListMigrationObjectLog(mdsId);
      	
      	for(String message: messages){
          	move message, "parm/+messages/message";
        }
    }
}    CM  013    0000000000    00000    0000000000    N00000100000        0000010    0012CM_GetMgObEr026000000    00000GVYM000000000010    02150000            041260private List<String> getListMigrationObjectLog(String mdsId) {

	List<String> migrationErrorMessage = new ArrayList();
  
	PreparedStatementQuery query = createPreparedStatement("""    
			SELECT 
            	mol.MIGR_OBJ_ID, mol.SEQNO 
    		FROM 
        		F1_MIGR_OBJ mo, F1_MIGR_OBJ_LOG mol 
    		WHERE 
        		mo.MIGR_DATA_SET_ID = :mdsId 
        		AND mo.BO_STATUS_CD = :boStatusCd
        		AND mo.MIGR_OBJ_ID = mol.MIGR_OBJ_ID
        		AND LOG_ENTRY_TYPE_FLG = :logEntryTypeFlg
                                                           
		""", "Get Migration Object Log Message");

		query.bindString("mdsId", mdsId, "mdsId");
		query.bindString("boStatusCd", "APPLIEDERROR", "boStatusCd");
		query.bindLookup("logEntryTypeFlg", LogEntryTypeLookup.constants.EXCEPTION);
  		List<SQLResultRow> result = query.list();
  		for(SQLResultRow row : result){
          	MigrationObject_Id migrationObjectId = new MigrationObject_Id(row.getString("MIGR_OBJ_ID"));
          	BigInteger sequence = row.getInteger("SEQNO");
			MigrationObjectLog migrationObjectLog = new MigrationObjectLog_Id(migrationObjectId, sequence).getEntity();
          	migrationErrorMessage.add(migrationObjectLog.getMessageText());
        }

		return migrationErrorMessage;
}    CM  014    0000000000    00000    0000000000    N00000100000        0000010    0012CM_GetMgObEr022000000    00000GVIM000000000010    0190000            03599import com.splwg.base.api.sql.PreparedStatementQuery
import com.splwg.base.domain.migration.object.MigrationObjectLog
import com.splwg.d1.api.lookup.LogEntryTypeLookup
import java.lang.Object
import com.splwg.base.domain.migration.object.MigrationObject_Id
import com.splwg.base.domain.migration.object.MigrationObjectLog_Id
import com.splwg.base.api.sql.SQLResultRow
import com.splwg.base.api.datatypes.Bool//System generated imports
import com.splwg.base.domain.migration.dataset.MigrationDataSet
import com.splwg.base.domain.migration.dataset.MigrationDataSet_Id
//End of system generated imports    CM  015    0000000000    00000    0000000000    N00000100000        0000010    0012CM_GetMgObEr024000000    00000GVYM000000000010    0130000            03103private String status;
private String mdsId;
private String hasErrorObjs;
private String hasErrorTrans;    CM  016    14CI_SCR_FLD_MAP01012CI_SCR_PRMPT01014CI_SCR_PRMPT_L01013CI_SCR_STEP_L0160110012CM_GetMgObEr0003ENG011N00203Program Description:
This script will retrieve the error in migration object log
Change History:
Date:                     by:                  Reason:
2025-Oct-10       JMella            Initial VersionCM  0120012CM_GetMgObEr0003ENG012N00013Invoke methodCM  0130012CM_GetMgObEr0003ENG011N00004MainCM  0140012CM_GetMgObEr0003ENG011N00037Retrieve Migration Object Log MessageCM  0150012CM_GetMgObEr0003ENG012N00006ImportCM  0160012CM_GetMgObEr0003ENG011N00009ConstantsCM  09F1_SCHEMA0110012CM_GetMgObErF1SC01803251<schema> 
    <mdsId dataType="string"/>  
    <status dataType="string"/>  
    <statusDescription dataType="string"/>  
    <hasError dataType="boolean"/>  
    <messages type="list"> 
        <message dataType="string"/> 
    </messages> 
</schema>CM13F1-ScriptOnly06SCRIPT01011CM_AddMgrDt01106SCRIPT01011CM_AddMgrDt19F1-ScriptPhysicalBO0100415381206CI_SCR0110011CM_AddMgrDtSENE017    SVSC    0008F1-DFLTSCM  0000F13014CI_SCR_CRT_GRP01010CI_SCR_CRT01016CI_SCR_CRT_GRP_L01009CI_SCR_DA0120011CM_AddMgrDt00020F1-MigrDataSetImportSCHM0020F1-MigrDataSetImportF1BO011CM  0011CM_AddMgrDt00004parmSCSM0011CM_AddMgrDtF1SC011CM  08CI_SCR_L0110011CM_AddMgrDt0003ENG01100025Add Migration Data ImportCM  0000011CI_SCR_STEP0120000000000    00000    0000000000    N00000100000        0000010    0011CM_AddMgrDt021000000    00000LABL000000000010    0120000            010    CM  011    0000000000    00000    0000000000    N00000100000        0000010    0011CM_AddMgrDt022000000    00000EDDT000000000010    0130000            03528move "parm/fileName" to "F1-MigrDataSetImport/fileName";
move "$USER" to "F1-MigrDataSetImport/user";
move 'F1YS' to "F1-MigrDataSetImport/shouldAutoApply";
move 'PENDING' to "F1-MigrDataSetImport/boStatus";
move 'F1-MigrDataSetImport' to "F1-MigrDataSetImport/bo";
move 'APPROVED' to "F1-MigrDataSetImport/defaultStatusForAdd";
move 'APPROVED' to "F1-MigrDataSetImport/defaultStatusForChange";
invokeBO 'F1-MigrDataSetImport' using "F1-MigrDataSetImport" for add;
move "F1-MigrDataSetImport/migrationDataSetId" to "parm/mdsId";    CM  012    14CI_SCR_FLD_MAP01012CI_SCR_PRMPT01014CI_SCR_PRMPT_L01013CI_SCR_STEP_L0120110011CM_AddMgrDt0003ENG011N00033/*Add Migration Data Set Import*/CM  0120011CM_AddMgrDt0003ENG011N00015Add BO InstanceCM  09F1_SCHEMA0110011CM_AddMgrDtF1SC0120287<schema> 
    <fileName dataType="string"/>  
    <mdsId dataType="string"/> 
</schema>CM